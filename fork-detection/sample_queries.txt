CALL apoc.export.csv.query("CALL apoc.periodic.commit(\"LOAD CSV WITH HEADERS FROM "file:///list_of_forks_apoc_subgraph_git_master_6M_snapshots.csv" AS row WITH row.node_id AS query_revision_id, row.snapshot_id AS query_snapshot_id MATCH (r:Revision{id: query_revision_id}) WITH query_revision_id, query_snapshot_id, r CALL apoc.path.subgraphNodes(r, {relationshipFilter: \"<PARENT\"}) YIELD node WITH query_revision_id, query_snapshot_id, node MATCH(fork_snapshot:Snapshot)-[:BRANCH]->(node)  WHERE fork_snapshot.type is null and fork_snapshot.id <> query_snapshot_id WITH query_revision_id, query_snapshot_id, fork_snapshot.id AS fork_snapshot_id RETURN DISTINCT query_snapshot_id, query_revision_id, fork_snapshot_id;\"), {limit: 100000});", "/mnt/17volume/data/list_of_forks_apoc_subgraph_git_master_verified_6M.csv", {});


CALL apoc.export.csv.query("CALL apoc.load.csv(file:///list_of_forks_apoc_subgraph_git_master_6M_snapshots.csv, {skip: 1, limit: 100000}) yield lineNo, list, map WITH map            MATCH (r:Revision{id: map.node_id}) WITH map.node_id AS query_revision_id, map.snapshot_id AS query_snapshot_id, r                 CALL apoc.path.subgraphNodes(r, {relationshipFilter: '<PARENT'}) YIELD node WITH query_revision_id, query_snapshot_id, node MATCH(fork_snapshot:Snapshot)-[:BRANCH]->(node)  WHERE fork_snapshot.type is null and fork_snapshot.id <> query_snapshot_id WITH query_revision_id, query_snapshot_id, fork_snapshot.id AS fork_snapshot_id RETURN DISTINCT query_snapshot_id, query_revision_id, fork_snapshot_id;", /mnt/17volume/data/list_of_forks_apoc_subgraph_git_master_verified_6M1.csv, {})

709683369
